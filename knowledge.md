# ドット絵変換アプリケーション開発ナレッジ

## 画像処理のベストプラクティス

- 大きな画像を処理する場合は、非同期処理（setTimeout, requestAnimationFrame）を使用して UI のブロックを防ぐ
- Canvas API を使用する際は、必要最小限のサイズで処理を行い、表示時に拡大する
- 画像処理は計算コストが高いため、処理中は UI を無効化し、ユーザーに進行状況を伝える

## ドット絵変換アルゴリズム

- 画像の縮小と拡大を組み合わせることで、ピクセル化効果を実現できる
- 色数削減には量子化アルゴリズムが効果的
- imageSmoothingEnabled = false を設定することで、ピクセル間の補間を無効化できる

## エラーハンドリングとログ

- try-catch ブロックを使用して、画像処理中のエラーを捕捉する
- エラーログはユーザーに表示するだけでなく、永続化する仕組みを用意する
- window.onerror イベントを使用して、未処理のエラーを捕捉する

## クラッシュ検知

- 長時間の無応答状態を検知するには、定期的なアクティビティチェックが有効
- localStorage を使用して、エラー情報を永続化できる
- beforeunload イベントを使用して、処理中のページ離脱を検知できる

## パフォーマンス最適化

- 大きな画像の処理は、Web Worker に委譲することでメインスレッドのブロックを防げる
- キャンバスのサイズは必要最小限に保ち、DOM 操作を最小限にする
- 複雑な処理は、小さなステップに分割して非同期で実行する

## ユーザーインターフェース設計

- 処理中は視覚的なフィードバックを提供する
- スライダーなどの入力要素には、現在の値を表示する
- ダウンロードボタンは、変換完了後にのみ有効化する

## ブラウザ互換性

- Canvas API は最新のブラウザで広くサポートされているが、古いブラウザでは機能が制限される
- FileReader API を使用する際は、ブラウザの互換性を考慮する
- CSS の flexbox を使用する場合は、ベンダープレフィックスを考慮する 